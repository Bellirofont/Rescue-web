<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <title>PSO MapBY Dfly v1.2 — модульная версия</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/@geoman-io/leaflet-geoman-free@2.17.0/dist/leaflet-geoman-free.css" />
    <link rel="stylesheet" href="css/style.css" />
</head>
<body>
<div id="map"></div>
<div id="sidebar">
    <h2>PSO Координатор v1.2</h2>
    <button onclick="clearAll()">Очистить всё</button>
    <button onclick="startDrawing()" class="primary">Нарисовать полигон поиска</button>
    <button onclick="saveProject()">Сохранить проект</button>
    <button onclick="loadProject()">Загрузить проект</button>
    <hr>
    <div id="gridControls" style="display:none;">
        <h4>Грид</h4>
        <select id="gridPreset">
            <option value="100">100 м</option>
            <option value="150">150 м</option>
            <option value="200" selected>200 м</option>
            <option value="250">250 м</option>
            <option value="500">500 м</option>
            <option value="1000">1 км</option>
        </select>
        <input type="number" id="gridCustom" placeholder="Своё (м)">
        <button onclick="generateGrid()" class="primary">Сгенерировать грид</button>
    </div>
    <hr>
    <h4>Группы</h4>
    <input id="baseCall" placeholder="База (Трест)" value="Трест">
    <input type="number" id="startNum" placeholder="Стартовый № (пусто=авто)">
    <input type="number" id="people" placeholder="Людей" value="5">
    <input type="number" id="cars" placeholder="Авто" value="0">
    <label><input type="checkbox" id="hasBla"> БЛА (приоритет)</label>
    <button onclick="addGroup()" class="accent">Добавить группу</button>
    <button onclick="assignZones()" class="danger">Распределить зоны</button>
    <table id="groupsTable"><tr><th>Позывной</th><th>Люди</th><th>Авто</th><th>БЛА</th><th>Площадь м²</th><th>Квадратов</th></tr></table>
    <hr>
    <button onclick="exportGeoJSON()">Экспорт GeoJSON</button>
    <button onclick="exportKML()">Экспорт KML</button>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/@turf/turf@6.5.0/turf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@turf/clusters-kmeans@6.5.0"></script>
<script src="https://unpkg.com/@geoman-io/leaflet-geoman-free@2.17.0/dist/leaflet-geoman-free.min.js"></script>
<script src="https://unpkg.com/leaflet-kml@1.0.1/L.KML.min.js"></script>
<script src="js/app.js"></script>
</body>
</html>
