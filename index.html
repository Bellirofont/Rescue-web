<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <title>PSO MapBY Dfly ‚Äî –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –ø–æ–∏—Å–∫–æ–≤—ã—Ö —Ä–∞–±–æ—Ç</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet-draw@1.0.4/dist/leaflet.draw.css" />
</head>
<body>
<div id="map"></div>
<div id="sidebar">
    <h2>PSO –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä</h2>

    <button onclick="window.startDrawing()" class="primary">üé® –ù–∞—Ä–∏—Å–æ–≤–∞—Ç—å –ø–æ–ª–∏–≥–æ–Ω –ø–æ–∏—Å–∫–∞</button>
    <button onclick="window.clearMap()" class="danger">–û—á–∏—Å—Ç–∏—Ç—å –∫–∞—Ä—Ç—É</button>
    <button onclick="window.saveProject()" class="primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–ª–∞–Ω –ø–æ–∏—Å–∫–∞</button>
    <button onclick="window.loadProject()" class="primary">–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–ª–∞–Ω –ø–æ–∏—Å–∫–∞</button>
    <hr>
    <h4>–ò–º–ø–æ—Ä—Ç/–≠–∫—Å–ø–æ—Ä—Ç</h4>
    <input type="file" id="kmlFileInput" class="file-upload" accept=".kml,.kmz">
    <button onclick="document.getElementById('kmlFileInput').click()" class="upload">–ó–∞–≥—Ä—É–∑–∏—Ç—å KML/KMZ</button>
    <button onclick="window.exportGeoJSON()" class="primary">–≠–∫—Å–ø–æ—Ä—Ç GeoJSON</button>
    <button onclick="window.exportKML()" class="primary">–≠–∫—Å–ø–æ—Ä—Ç KML</button>
    <hr>
    <div id="gridControls" style="display:none;">
        <h4>–ì—Ä–∏–¥</h4>
        <select id="gridPreset">
            <option value="100">100 –º</option>
            <option value="150">150 –º</option>
            <option value="200" selected>200 –º</option>
            <option value="250">250 –º</option>
            <option value="500">500 –º</option>
            <option value="1000">1 –∫–º</option>
        </select>
        <input type="number" id="gridCustom" placeholder="–°–≤–æ—ë (–º)">
        <button onclick="window.generateGrid()" class="primary">–ù–∞–Ω–µ—Å—Ç–∏ —Å–µ—Ç–∫—É</button>
        <div id="roadStatus" style="margin-top: 10px; padding: 5px; border-radius: 5px;"></div>
    </div>
    <hr>
    <h4>–ì—Ä—É–ø–ø—ã</h4>
    <div id="groupForm">
        <input id="baseCall" placeholder="–ë–∞–∑–∞ (–¢—Ä–µ—Å—Ç)" value="–¢—Ä–µ—Å—Ç">
        <input type="number" id="startNum" placeholder="–°—Ç–∞—Ä—Ç–æ–≤—ã–π ‚Ññ (–ø—É—Å—Ç–æ=–∞–≤—Ç–æ)">
        <input type="number" id="people" placeholder="–õ—é–¥–µ–π" value="5">
        <input type="number" id="cars" placeholder="–ê–≤—Ç–æ" value="0">
        <input type="number" id="blaNum" placeholder="–ë–õ–ê (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ)" value="0">
        <button onclick="window.addGroup()" class="accent" id="addGroupButton">–î–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–ø–ø—É</button>
        <button onclick="window.updateGroup()" class="accent" id="updateGroupButton" style="display:none;">–û–±–Ω–æ–≤–∏—Ç—å –≥—Ä—É–ø–ø—É</button>
        <button onclick="window.cancelGroupEdit()" class="danger" id="cancelGroupButton" style="display:none;">–û—Ç–º–µ–Ω–∞</button>
    </div>
    <button onclick="window.assignZones()" class="danger">–†–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∑–æ–Ω—ã</button>
    <div class="distribution-stats">
        <strong>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è:</strong>
        <div id="distributionStats"></div>
    </div>
    <table id="groupsTable"><tr><th>–ü–æ–∑—ã–≤–Ω–æ–π</th><th>–õ—é–¥–∏</th><th>–ê–≤—Ç–æ</th><th>–ë–õ–ê</th><th>–ü–ª–æ—â–∞–¥—å –∫–º¬≤</th><th>–ö–≤–∞–¥—Ä–∞—Ç–æ–≤</th><th>–í–µ—Å</th><th>–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</th><th>–°–ª–æ–∂–Ω–æ—Å—Ç—å</th><th>–¢–∏–ø –∑–æ–Ω—ã</th><th>–î–µ–π—Å—Ç–≤–∏—è</th></tr></table>
    <hr>
    <h4>–ú–∞—Ä—à—Ä—É—Ç—ã</h4>
    <input type="number" id="stepPesh" placeholder="–®–∞–≥ –ø–µ—à–∏—Ö (–º)" value="10">
    <input type="number" id="stepBla" placeholder="–®–∞–≥ –ë–õ–ê (–º)" value="50">
    <button onclick="window.generateRoutes()" class="accent">–ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã</button>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/@turf/turf@6.5.0/turf.min.js"></script>
<script src="https://unpkg.com/leaflet-draw@1.0.4/dist/leaflet.draw.js"></script>
<script src="https://cdn.jsdelivr.net/npm/leaflet-kml@1.0.1/L.KML.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="js/main.js" defer></script>
<script src="js/models/group-model.js" defer></script>
<script src="js/models/terrain-model.js" defer></script>
<script src="js/models/missing-person-model.js" defer></script>
<script src="js/services/grid-service.js" defer></script>
<script src="js/services/road-service.js" defer></script>
<script src="js/services/allocation-service.js" defer></script>
<script src="js/utils/turf-utils.js" defer></script>
<script src="js/utils/geo-utils.js" defer></script>
<script src="js/app.js" defer></script>
</body>
</html>
